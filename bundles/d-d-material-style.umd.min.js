!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("@angular/core")):"function"==typeof define&&define.amd?define(["exports","@angular/core"],e):e(t["d-d-material-style"]={},t.core)}(this,function(t,p){"use strict";var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function i(t,e){return t(e={exports:{}},e.exports),e.exports}var r="undefined"!=typeof window&&window,n="undefined"!=typeof self&&"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&self,o=r||void 0!==e&&e||n,s=o;!function(){if(!o)throw new Error("RxJS could not find any global context (window, self, global)")}();var c={root:s};var h={isFunction:function(t){return"function"==typeof t}},l={isArray:Array.isArray||function(t){return t&&"number"==typeof t.length}};var a,d={isObject:function(t){return null!=t&&"object"==typeof t}},u={errorObject:{e:{}}};function f(){try{return a.apply(this,arguments)}catch(t){return u.errorObject.e=t,u.errorObject}}var b={tryCatch:function(t){return a=t,f}},_=e&&e.__extends||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);function r(){this.constructor=t}t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},m={UnsubscriptionError:function(i){function t(t){i.call(this),this.errors=t;var e=Error.call(this,t?t.length+" errors occurred during unsubscription:\n  "+t.map(function(t,e){return e+1+") "+t.toString()}).join("\n  "):"");this.name=e.name="UnsubscriptionError",this.stack=e.stack,this.message=e.message}return _(t,i),t}(Error)};function y(t){return t.reduce(function(t,e){return t.concat(e instanceof m.UnsubscriptionError?e.errors:e)},[])}var g={Subscription:function(){function r(t){this.closed=!1,this._parent=null,this._parents=null,this._subscriptions=null,t&&(this._unsubscribe=t)}var t;return r.prototype.unsubscribe=function(){var t,e=!1;if(!this.closed){var i=this._parent,r=this._parents,n=this._unsubscribe,o=this._subscriptions;this.closed=!0,this._parent=null,this._parents=null,this._subscriptions=null;for(var s=-1,c=r?r.length:0;i;)i.remove(this),i=++s<c&&r[s]||null;if(h.isFunction(n))b.tryCatch(n).call(this)===u.errorObject&&(e=!0,t=t||(u.errorObject.e instanceof m.UnsubscriptionError?y(u.errorObject.e.errors):[u.errorObject.e]));if(l.isArray(o))for(s=-1,c=o.length;++s<c;){var a=o[s];if(d.isObject(a))if(b.tryCatch(a.unsubscribe).call(a)===u.errorObject){e=!0,t=t||[];var p=u.errorObject.e;p instanceof m.UnsubscriptionError?t=t.concat(y(p.errors)):t.push(p)}}if(e)throw new m.UnsubscriptionError(t)}},r.prototype.add=function(t){if(!t||t===r.EMPTY)return r.EMPTY;if(t===this)return this;var e=t;switch(typeof t){case"function":e=new r(t);case"object":if(e.closed||"function"!=typeof e.unsubscribe)return e;if(this.closed)return e.unsubscribe(),e;if("function"!=typeof e._addParent){var i=e;(e=new r)._subscriptions=[i]}break;default:throw new Error("unrecognized teardown "+t+" added to Subscription.")}return(this._subscriptions||(this._subscriptions=[])).push(e),e._addParent(this),e},r.prototype.remove=function(t){var e=this._subscriptions;if(e){var i=e.indexOf(t);-1!==i&&e.splice(i,1)}},r.prototype._addParent=function(t){var e=this._parent,i=this._parents;e&&e!==t?i?-1===i.indexOf(t)&&i.push(t):this._parents=[t]:this._parent=t},r.EMPTY=((t=new r).closed=!0,t),r}()},v={closed:!0,next:function(t){},error:function(t){throw t},complete:function(){}},w=i(function(t,e){var i=c.root.Symbol;e.rxSubscriber="function"==typeof i&&"function"==typeof i.for?i.for("rxSubscriber"):"@@rxSubscriber",e.$$rxSubscriber=e.rxSubscriber}),x=(w.rxSubscriber,w.$$rxSubscriber,e&&e.__extends||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);function r(){this.constructor=t}t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),S=function(o){function n(t,e,i){switch(o.call(this),this.syncErrorValue=null,this.syncErrorThrown=!1,this.syncErrorThrowable=!1,this.isStopped=!1,arguments.length){case 0:this.destination=v;break;case 1:if(!t){this.destination=v;break}if("object"==typeof t){if((n=t)instanceof S||"syncErrorThrowable"in n&&n[w.rxSubscriber]){var r=t[w.rxSubscriber]();this.syncErrorThrowable=r.syncErrorThrowable,(this.destination=r).add(this)}else this.syncErrorThrowable=!0,this.destination=new O(this,t);break}default:this.syncErrorThrowable=!0,this.destination=new O(this,t,e,i)}var n}return x(n,o),n.prototype[w.rxSubscriber]=function(){return this},n.create=function(t,e,i){var r=new n(t,e,i);return r.syncErrorThrowable=!1,r},n.prototype.next=function(t){this.isStopped||this._next(t)},n.prototype.error=function(t){this.isStopped||(this.isStopped=!0,this._error(t))},n.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},n.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,o.prototype.unsubscribe.call(this))},n.prototype._next=function(t){this.destination.next(t)},n.prototype._error=function(t){this.destination.error(t),this.unsubscribe()},n.prototype._complete=function(){this.destination.complete(),this.unsubscribe()},n.prototype._unsubscribeAndRecycle=function(){var t=this._parent,e=this._parents;return this._parent=null,this._parents=null,this.unsubscribe(),this.closed=!1,this.isStopped=!1,this._parent=t,this._parents=e,this},n}(g.Subscription),E=S,O=function(s){function t(t,e,i,r){var n;s.call(this),this._parentSubscriber=t;var o=this;h.isFunction(e)?n=e:e&&(n=e.next,i=e.error,r=e.complete,e!==v&&(o=Object.create(e),h.isFunction(o.unsubscribe)&&this.add(o.unsubscribe.bind(o)),o.unsubscribe=this.unsubscribe.bind(this))),this._context=o,this._next=n,this._error=i,this._complete=r}return x(t,s),t.prototype.next=function(t){if(!this.isStopped&&this._next){var e=this._parentSubscriber;e.syncErrorThrowable?this.__tryOrSetError(e,this._next,t)&&this.unsubscribe():this.__tryOrUnsub(this._next,t)}},t.prototype.error=function(t){if(!this.isStopped){var e=this._parentSubscriber;if(this._error)e.syncErrorThrowable?this.__tryOrSetError(e,this._error,t):this.__tryOrUnsub(this._error,t),this.unsubscribe();else{if(!e.syncErrorThrowable)throw this.unsubscribe(),t;e.syncErrorValue=t,e.syncErrorThrown=!0,this.unsubscribe()}}},t.prototype.complete=function(){var t=this;if(!this.isStopped){var e=this._parentSubscriber;if(this._complete){var i=function(){return t._complete.call(t._context)};e.syncErrorThrowable?this.__tryOrSetError(e,i):this.__tryOrUnsub(i),this.unsubscribe()}else this.unsubscribe()}},t.prototype.__tryOrUnsub=function(t,e){try{t.call(this._context,e)}catch(t){throw this.unsubscribe(),t}},t.prototype.__tryOrSetError=function(e,t,i){try{t.call(this._context,i)}catch(t){return e.syncErrorValue=t,e.syncErrorThrown=!0}return!1},t.prototype._unsubscribe=function(){var t=this._parentSubscriber;this._context=null,this._parentSubscriber=null,t.unsubscribe()},t}(S);var D={Subscriber:E};var j={toSubscriber:function(t,e,i){if(t){if(t instanceof D.Subscriber)return t;if(t[w.rxSubscriber])return t[w.rxSubscriber]()}return t||e||i?new D.Subscriber(t,e,i):new D.Subscriber(v)}},C=i(function(t,e){function i(t){var e,i=t.Symbol;return"function"==typeof i?i.observable?e=i.observable:(e=i("observable"),i.observable=e):e="@@observable",e}e.getSymbolObservable=i,e.observable=i(c.root),e.$$observable=e.observable});C.getSymbolObservable,C.observable,C.$$observable;var k={noop:function(){}};function P(e){return e?1===e.length?e[0]:function(t){return e.reduce(function(t,e){return e(t)},t)}:k.noop}var R={pipe:function(){for(var t=[],e=0;e<arguments.length;e++)t[e-0]=arguments[e];return P(t)},pipeFromArray:P},X={Observable:function(){function i(t){this._isScalar=!1,t&&(this._subscribe=t)}return i.prototype.lift=function(t){var e=new i;return e.source=this,e.operator=t,e},i.prototype.subscribe=function(t,e,i){var r=this.operator,n=j.toSubscriber(t,e,i);if(r?r.call(n,this.source):n.add(this.source||!n.syncErrorThrowable?this._subscribe(n):this._trySubscribe(n)),n.syncErrorThrowable&&(n.syncErrorThrowable=!1,n.syncErrorThrown))throw n.syncErrorValue;return n},i.prototype._trySubscribe=function(e){try{return this._subscribe(e)}catch(t){e.syncErrorThrown=!0,e.syncErrorValue=t,e.error(t)}},i.prototype.forEach=function(r,t){var n=this;if(t||(c.root.Rx&&c.root.Rx.config&&c.root.Rx.config.Promise?t=c.root.Rx.config.Promise:c.root.Promise&&(t=c.root.Promise)),!t)throw new Error("no Promise impl found");return new t(function(t,e){var i;i=n.subscribe(function(t){if(i)try{r(t)}catch(t){e(t),i.unsubscribe()}else r(t)},e,t)})},i.prototype._subscribe=function(t){return this.source.subscribe(t)},i.prototype[C.observable]=function(){return this},i.prototype.pipe=function(){for(var t=[],e=0;e<arguments.length;e++)t[e-0]=arguments[e];return 0===t.length?this:R.pipeFromArray(t)(this)},i.prototype.toPromise=function(t){var r=this;if(t||(c.root.Rx&&c.root.Rx.config&&c.root.Rx.config.Promise?t=c.root.Rx.config.Promise:c.root.Promise&&(t=c.root.Promise)),!t)throw new Error("no Promise impl found");return new t(function(t,e){var i;r.subscribe(function(t){return i=t},function(t){return e(t)},function(){return t(i)})})},i.create=function(t){return new i(t)},i}()},T=e&&e.__extends||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);function r(){this.constructor=t}t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},Y={ObjectUnsubscribedError:function(e){function t(){var t=e.call(this,"object unsubscribed");this.name=t.name="ObjectUnsubscribedError",this.stack=t.stack,this.message=t.message}return T(t,e),t}(Error)},M=e&&e.__extends||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);function r(){this.constructor=t}t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},U={SubjectSubscription:function(i){function t(t,e){i.call(this),this.subject=t,this.subscriber=e,this.closed=!1}return M(t,i),t.prototype.unsubscribe=function(){if(!this.closed){this.closed=!0;var t=this.subject,e=t.observers;if(this.subject=null,e&&0!==e.length&&!t.isStopped&&!t.closed){var i=e.indexOf(this.subscriber);-1!==i&&e.splice(i,1)}}},t}(g.Subscription)},V=e&&e.__extends||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);function r(){this.constructor=t}t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},W=function(e){function t(t){e.call(this,t),this.destination=t}return V(t,e),t}(D.Subscriber),I=function(e){function t(){e.call(this),this.observers=[],this.closed=!1,this.isStopped=!1,this.hasError=!1,this.thrownError=null}return V(t,e),t.prototype[w.rxSubscriber]=function(){return new W(this)},t.prototype.lift=function(t){var e=new F(this,this);return e.operator=t,e},t.prototype.next=function(t){if(this.closed)throw new Y.ObjectUnsubscribedError;if(!this.isStopped)for(var e=this.observers,i=e.length,r=e.slice(),n=0;n<i;n++)r[n].next(t)},t.prototype.error=function(t){if(this.closed)throw new Y.ObjectUnsubscribedError;this.hasError=!0,this.thrownError=t,this.isStopped=!0;for(var e=this.observers,i=e.length,r=e.slice(),n=0;n<i;n++)r[n].error(t);this.observers.length=0},t.prototype.complete=function(){if(this.closed)throw new Y.ObjectUnsubscribedError;this.isStopped=!0;for(var t=this.observers,e=t.length,i=t.slice(),r=0;r<e;r++)i[r].complete();this.observers.length=0},t.prototype.unsubscribe=function(){this.isStopped=!0,this.closed=!0,this.observers=null},t.prototype._trySubscribe=function(t){if(this.closed)throw new Y.ObjectUnsubscribedError;return e.prototype._trySubscribe.call(this,t)},t.prototype._subscribe=function(t){if(this.closed)throw new Y.ObjectUnsubscribedError;return this.hasError?(t.error(this.thrownError),g.Subscription.EMPTY):this.isStopped?(t.complete(),g.Subscription.EMPTY):(this.observers.push(t),new U.SubjectSubscription(this,t))},t.prototype.asObservable=function(){var t=new X.Observable;return t.source=this,t},t.create=function(t,e){return new F(t,e)},t}(X.Observable),A=I,F=function(i){function t(t,e){i.call(this),this.destination=t,this.source=e}return V(t,i),t.prototype.next=function(t){var e=this.destination;e&&e.next&&e.next(t)},t.prototype.error=function(t){var e=this.destination;e&&e.error&&this.destination.error(t)},t.prototype.complete=function(){var t=this.destination;t&&t.complete&&this.destination.complete()},t.prototype._subscribe=function(t){return this.source?this.source.subscribe(t):g.Subscription.EMPTY},t}(I);function H(t,e,i,r){var n,o=arguments.length,s=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,r);else for(var c=t.length-1;0<=c;c--)(n=t[c])&&(s=(o<3?n(s):3<o?n(e,i,s):n(e,i))||s);return 3<o&&s&&Object.defineProperty(e,i,s),s}function L(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}var $=function(){function t(){this._collection=[],this.grid={minX:9999,maxX:-9999,minY:9999,maxY:-9999},this.change=new A,this.drop=new A}return t.prototype.add=function(t){var e=this;this._collection.push(t),this._collection.forEach(function(t){e.grid.minX=e.grid.minX>t.point.x?t.point.x:e.grid.minX,e.grid.maxX=e.grid.maxX<t.point.x?t.point.x:e.grid.maxX,e.grid.minY=e.grid.minY>t.point.y?t.point.y:e.grid.minY,e.grid.maxY=e.grid.maxY<t.point.y?t.point.y:e.grid.maxY})},t.prototype.sorting=function(){this._collection.sort(function(t,e){return t.point.x<e.point.x?t.point.y>e.point.y?-1:1:t.point.y<e.point.y&&t.point.y<e.point.y?1:-1}).reverse()},Object.defineProperty(t.prototype,"active",{set:function(e){this._collection.forEach(function(t){return t.active=t.point.x===e.x&&t.point.y===e.y})},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"collection",{get:function(){return this._collection},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"customCollection",{get:function(){return this._collection.map(function(t){return t.customEl})},enumerable:!0,configurable:!0}),t.prototype.getCoords=function(t){var e=t.getBoundingClientRect();return{top:Math.round(e.top+pageYOffset),left:Math.round(e.left+pageXOffset)}},t=H([p.Injectable(),L("design:paramtypes",[])],t)}(),Z=function(){function t(){}return t=H([p.Component({selector:"d-d-mat-box-style",template:"<ng-content></ng-content>",styles:["/deep/ d-d-mat-box-style {\n  transition: all 300ms ease-out;\n  transform: translateZ(0);\n  position: absolute;\n  float: left;\n  user-select: none;\n  border-radius: 5px; }\n  /deep/ d-d-mat-box-style.d-d-move {\n    transition: unset;\n    transform: translateZ(6px);\n    box-shadow: 0 0 4px rgba(0, 0, 0, 0.25); }\n  /deep/ d-d-mat-box-style .ripple {\n    position: absolute;\n    top: 0;\n    left: 0;\n    bottom: 0;\n    right: 0;\n    overflow: hidden;\n    -webkit-transform: translateZ(0);\n    transform: translateZ(0);\n    border-radius: inherit;\n    pointer-events: none;\n    animation: ripple-shadow 0.4s forwards;\n    -webkit-animation: ripple-shadow 0.4s forwards; }\n    /deep/ d-d-mat-box-style .ripple .rippleWave {\n      backface-visibility: hidden;\n      position: absolute;\n      border-radius: 50%;\n      transform: scale(0.7);\n      -webkit-transform: scale(0.7);\n      background: rgba(0, 0, 0, 0.3);\n      opacity: 0.45;\n      animation: ripple 2s forwards;\n      -webkit-animation: ripple 2s forwards; }\n\n@keyframes ripple-shadow {\n  0% {\n    box-shadow: 0 0 0 rgba(0, 0, 0, 0); }\n  20% {\n    box-shadow: 0 4px 16px rgba(0, 0, 0, 0.3); }\n  100% {\n    box-shadow: 0 0 0 rgba(0, 0, 0, 0); } }\n\n@-webkit-keyframes ripple-shadow {\n  0% {\n    box-shadow: 0 0 0 rgba(0, 0, 0, 0); }\n  20% {\n    box-shadow: 0 4px 16px rgba(0, 0, 0, 0.3); }\n  100% {\n    box-shadow: 0 0 0 rgba(0, 0, 0, 0); } }\n\n@keyframes ripple {\n  to {\n    transform: scale(24);\n    opacity: 0; } }\n\n@-webkit-keyframes ripple {\n  to {\n    -webkit-transform: scale(24);\n    opacity: 0; } }\n\n/deep/ .d-d-shadow {\n  background: rgba(0, 0, 0, 0.4);\n  box-shadow: inset 0 0 24px rgba(255, 255, 255, 0.4);\n  border-radius: 5px;\n  position: absolute;\n  display: block;\n  transition: opacity 200ms ease-out; }\n"]}),L("design:paramtypes",[])],t)}(),N=function(){function t(t,e,i,r,n){this._elementRef=t,this._render=e,this._resolver=i,this._vcr=r,this._dDService=n,this.dChange=new p.EventEmitter,this.dDrop=new p.EventEmitter,this._margin={x:0,y:0},this._padding={x:0,y:0},this.is=!1,this.materialStyle=!0,this.shadow=!1}return e=t,Object.defineProperty(t.prototype,"config",{set:function(t){var e=this;t&&(this.direction=t.direction||null,this.materialStyle=void 0===t.matClick||t.matClick,this.shadow=void 0!==t.shadow&&t.shadow,this.customElem=t.elem||null,this.swipeElement=t.swipe||null,this.swipeElement&&setTimeout(function(){return e.swipeElement=e._elementRef.nativeElement.querySelector(e.swipeElement)||null}))},enumerable:!0,configurable:!0}),t.prototype.ngAfterViewInit=function(){var t=this._render.parentNode(this._elementRef.nativeElement);this.withContainer=-1!==e.COMP.indexOf(t.nodeName),this.init(t),this._setLimits()},t.prototype.init=function(t){var i=this;this._parent=this.withContainer?this._render.parentNode(t):t,this._setPadding(),this._setMargin(!0),this.point=this._dDService.getCoords(this._elementRef.nativeElement),setTimeout(function(){var t=i._resolver.resolveComponentFactory(Z),e=i._vcr.createComponent(t);i._elem=e.location.nativeElement,i._setMargin(!1),(!i.direction||"x"!==i.direction&&"grid"!==i.direction)&&(i._render.setStyle(i._elem,"width",i._elementRef.nativeElement.offsetWidth+"px"),i._render.setStyle(i._elem,"height",i._elementRef.nativeElement.offsetHeight+"px")),i._render.appendChild(i._elem,i._elementRef.nativeElement),i._render.setStyle(i._elem,"top",i._point.y+"px"),i._render.setStyle(i._elem,"left",i._point.x+"px"),i._dDService.add(i._getIEl())}),this._collect=this._dDService.collection},Object.defineProperty(t.prototype,"dDservice",{set:function(t){this._dDService=t},enumerable:!0,configurable:!0}),t.prototype.onDragStart=function(){return!1},t.prototype.onMouseDown=function(t){var e=this;if(this.swipeElement){var i=this._dDService.getCoords(this.swipeElement),r=i.top,n=i.left+this.swipeElement.offsetWidth,o=i.top+this.swipeElement.offsetHeight,s=i.left;t.pageY>=r&&t.pageY<=o&&t.pageX>=s&&t.pageX<=n&&(this.is=!0)}else this.is=!0;var c=this._dDService.getCoords(this._elem);if(this._shift={x:t.pageX-c.left,y:t.pageY-c.top},this.matClick(t),this.is){var a=this._elem.style.zIndex||1;this._render.addClass(this._elem,"d-d-move"),this._render.setStyle(this._elem,"zIndex",9999),this._dDService.active=this._point,this._collect=this._dDService.collection,this._addShadow(),this.coordinate=t,document.onmousemove=function(t){e.coordinate=t},document.onmouseup=function(){document.onmousemove=null,document.onmouseup=null,e.is=!1,e._removeShadow(),e._drop(),e._render.removeClass(e._elem,"d-d-move"),e._render.setStyle(e._elem,"zIndex",a)}}},t.prototype._setPadding=function(){this._padding.y=+window.getComputedStyle(this._parent,null).getPropertyValue("padding-top").replace(/\D+/g,""),this._padding.x=+window.getComputedStyle(this._parent,null).getPropertyValue("padding-left").replace(/\D+/g,"")},t.prototype._setMargin=function(t){t?(this._margin.y=+window.getComputedStyle(this._elementRef.nativeElement,null).getPropertyValue("margin-top").replace(/\D+/g,"")+ +window.getComputedStyle(this._elementRef.nativeElement,null).getPropertyValue("margin-bottom").replace(/\D+/g,""),this._margin.x=+window.getComputedStyle(this._elementRef.nativeElement,null).getPropertyValue("margin-left").replace(/\D+/g,"")+ +window.getComputedStyle(this._elementRef.nativeElement,null).getPropertyValue("margin-right").replace(/\D+/g,"")):(this._render.setStyle(this._elementRef.nativeElement,"marginTop","0"),this._render.setStyle(this._elementRef.nativeElement,"marginRight","0"),this._render.setStyle(this._elementRef.nativeElement,"marginBottom","0"),this._render.setStyle(this._elementRef.nativeElement,"marginLeft","0"))},t.prototype._setLimits=function(){if(this.container){var t=this._dDService.getCoords(this.container);this._limits={top:t.top,right:this.container.offsetWidth+t.left-this._elementRef.nativeElement.offsetWidth,bottom:this.container.offsetHeight+t.top-this._elementRef.nativeElement.offsetHeight,left:t.left},this._innerBox={top:t.top,right:this.container.offsetWidth+t.left,bottom:this.container.offsetHeight+t.top,left:t.left}}},Object.defineProperty(t.prototype,"coordinate",{set:function(t){var e=Object.assign({},this._shift),i={x:t.pageX,y:t.pageY};this._limits&&t.pageX-this._shift.x>=this._limits.right?(i.x=this._limits.right,this._shift.x=t.pageX-this._limits.right,e.x=0):this._limits&&t.pageX-this._shift.x<=this._limits.left&&(i.x=this._limits.left,this._shift.x=t.pageX-this._limits.left,e.x=0),this._limits&&t.pageY-this._shift.y>=this._limits.bottom?(i.y=this._limits.bottom,this._shift.y=t.pageY-this._limits.bottom,e.y=0):this._limits&&t.pageY-this._shift.y<=this._limits.top&&(i.y=this._limits.top,this._shift.y=t.pageY-this._limits.top,e.y=0);var r=this._dDService.getCoords(this._parent),n={x:i.x-e.x-r.left,y:i.y-e.y-r.top};this._render.setStyle(this._elem,"left",n.x+"px"),this._render.setStyle(this._elem,"top",n.y+"px"),this.direction?this.swipe(n):(this._point=n,this._emit("change"))},enumerable:!0,configurable:!0}),t.prototype._addShadow=function(){if(this.shadow){this._dDService.shadow=this._render.createElement("div");var t=this._elem.offsetWidth,e=this._elem.offsetHeight;this._render.setStyle(this._dDService.shadow,"width",t-10+"px"),this._render.setStyle(this._dDService.shadow,"height",e-10+"px"),this._updateShadow(),this._render.addClass(this._dDService.shadow,"d-d-shadow"),this._render.insertBefore(this.withContainer?this._render.parentNode(this._elem):this._parent,this._dDService.shadow,this._elem)}},t.prototype._removeShadow=function(){this.shadow&&this._render.removeChild(this.withContainer?this._render.parentNode(this._elem):this._parent,this._dDService.shadow)},t.prototype.swipe=function(t){var e=this,i=this._elem.offsetHeight+this._margin.y,r=this._elem.offsetWidth+this._margin.x,n=Math.floor((t.y-this._padding.y+i/2)/i)*i+this._padding.y,o=Math.floor((t.x-this._padding.x+r/2)/r)*r+this._padding.x;n>this._dDService.grid.maxY?n=this._dDService.grid.maxY:n<this._dDService.grid.minY&&(n=this._dDService.grid.minY),o>this._dDService.grid.maxX?o=this._dDService.grid.maxX:o<this._dDService.grid.minX&&(o=this._dDService.grid.minX);var s=t.y<this._point.y?1:-1,c=t.x<this._point.x?1:-1;this._point.y===n&&this._point.x===o||(this._collect.forEach(function(t){e._point.y!==n&&"grid"===e.direction?e._point.y-(.5*i-1)<t.point.y&&e._point.y+(.5*i-1)>t.point.y&&(0<s&&t.point.x<e._point.x||s<0&&t.point.x>e._point.x)?e._setElements(t,{width:s*r}):n+(.5*i-1)<t.point.y&&e._point.y-(.5*i-1)>t.point.y?0<s&&e._dDService.grid.maxX-(.5*r-1)<t.point.x&&e._dDService.grid.maxX+(.5*r-1)>t.point.x?(e._setElements(t,{width:s*(t.point.x-e._dDService.grid.minX)}),e._setElements(t,{height:s*i})):s<0&&e._dDService.grid.minX-(.5*r-1)<t.point.x&&e._dDService.grid.minX+(.5*r-1)>t.point.x?(e._setElements(t,{width:s*(t.point.x-e._dDService.grid.maxX)}),e._setElements(t,{height:s*i})):e._setElements(t,{width:s*r}):n-(.5*i-1)<t.point.y&&n+(.5*i-1)>t.point.y&&(0<s&&t.point.x>o-(.5*r-1)||s<0&&t.point.x<o+(.5*r-1))&&(0<s&&e._dDService.grid.maxX-(.5*r-1)<t.point.x&&e._dDService.grid.maxX+(.5*r-1)>t.point.x?(e._setElements(t,{width:s*(e._dDService.grid.minX-t.point.x)}),e._setElements(t,{height:s*i})):s<0&&e._dDService.grid.minX-(.5*r-1)<t.point.x&&e._dDService.grid.minX+(.5*r-1)>t.point.x?(e._setElements(t,{width:s*(t.point.x-e._dDService.grid.maxX)}),e._setElements(t,{height:s*i})):e._setElements(t,{width:s*r})):e._point.x===o||"grid"!==e.direction&&"x"!==e.direction?e._point.y!==n&&"y"===e.direction&&e._point.x-(.5*r-1)<t.point.x&&e._point.x+(.5*r-1)>t.point.x&&e._point.y-s*i-(.5*i-1)<t.point.y&&e._point.y-s*i+(.5*i-1)>t.point.y&&e._setElements(t,{height:s*i}):e._point.y-(.5*i-1)<t.point.y&&e._point.y+(.5*i-1)>t.point.y&&e._point.x-c*r-(.5*r-1)<t.point.x&&e._point.x-c*r+(.5*r-1)>t.point.x&&e._setElements(t,{width:c*r})}),this._point.y=n,this._point.x=o,this._emit("change"),this.shadow&&this._updateShadow())},t.prototype._setElements=function(t,e){e.height?t.point.y+=e.height:t.point.x+=e.width,this._render.setStyle(t.el,e.height?"top":"left",(e.height?t.point.y:t.point.x)+"px")},t.prototype._updateShadow=function(){var t=this;this._render.setStyle(this._dDService.shadow,"opacity",0),setTimeout(function(){t._render.setStyle(t._dDService.shadow,"top",t._point.y+5+"px"),t._render.setStyle(t._dDService.shadow,"left",t._point.x+5+"px"),t._render.setStyle(t._dDService.shadow,"opacity",1)},200)},t.prototype._drop=function(){this._emit("drop"),this.direction&&"grid"===this.direction&&1<this._collect.length&&this._collect[this._collect.length-1].active&&(this._collect[this._collect.length-2].point.x+this._elem.offsetWidth>this._dDService.grid.maxX?this._point.x=this._dDService.grid.minX:(this._point.x=this._collect[this._collect.length-2].point.x+this._elem.offsetWidth+this._margin.x,this._point.y=this._collect[this._collect.length-2].point.y)),this._render.setStyle(this._elem,"top",this._point.y+"px"),this._render.setStyle(this._elem,"left",this._point.x+"px")},t.prototype._getIEl=function(){return{point:this._point,active:!1,el:this._elem,customEl:this.customElem||null}},Object.defineProperty(t.prototype,"point",{set:function(t){var e=this._dDService.getCoords(this._parent);this._point={x:Math.round(t.left-e.left-this._margin.x),y:Math.round(t.top-e.top-this._margin.y)}},enumerable:!0,configurable:!0}),t.prototype._emit=function(t){this._dDService.sorting();var e={type:t,point:this._point,elem:this.customElem||this._elem,collection:this.customElem?this._dDService.customCollection:this._collect};switch(t){case"change":this.dChange.emit(e),this._dDService.change.next(e);break;case"drop":this.dDrop.emit(e),this._dDService.drop.next(e)}},t.prototype.matClick=function(t){var e=this;if(this.materialStyle){var i=this._elem,r=this._shift;if(this.is&&this.swipeElement){i=this.swipeElement;var n=this._dDService.getCoords(this.swipeElement);r={x:t.pageX-n.left,y:t.pageY-n.top}}if(-1!==i.className.indexOf("btn-disabled"))return;var o=Math.min(i.offsetHeight,i.offsetWidth,100),s=this._render.createElement("div");this._render.addClass(s,"ripple"),this._render.appendChild(i,s);var c=this._render.createElement("div");this._render.addClass(c,"rippleWave"),this._render.setStyle(c,"width",o+"px"),this._render.setStyle(c,"height",o+"px"),this._render.setStyle(c,"left",r.x-o/2+"px"),this._render.setStyle(c,"top",r.y-o/2+"px"),s.appendChild(c),c.addEventListener("animationend",function(){return e._render.removeChild(i,s)})}},t.COMP="D-D-MATERIAL-STYLE",H([p.Input("ddMatStyle"),L("design:type",Object)],t.prototype,"container",void 0),H([p.Input(),L("design:type",Object),L("design:paramtypes",[Object])],t.prototype,"config",null),H([p.Output(),L("design:type","function"==typeof(i=void 0!==p.EventEmitter&&p.EventEmitter)&&i||Object)],t.prototype,"dChange",void 0),H([p.Output(),L("design:type","function"==typeof(r=void 0!==p.EventEmitter&&p.EventEmitter)&&r||Object)],t.prototype,"dDrop",void 0),H([p.HostListener("dragstart"),L("design:type",Function),L("design:paramtypes",[]),L("design:returntype",void 0)],t.prototype,"onDragStart",null),H([p.HostListener("mousedown",["$event"]),L("design:type",Function),L("design:paramtypes",[Object]),L("design:returntype",void 0)],t.prototype,"onMouseDown",null),t=e=H([p.Directive({selector:"[ddMatStyle]"}),L("design:paramtypes",["function"==typeof(n=void 0!==p.ElementRef&&p.ElementRef)&&n||Object,"function"==typeof(o=void 0!==p.Renderer2&&p.Renderer2)&&o||Object,"function"==typeof(s=void 0!==p.ComponentFactoryResolver&&p.ComponentFactoryResolver)&&s||Object,"function"==typeof(c=void 0!==p.ViewContainerRef&&p.ViewContainerRef)&&c||Object,"function"==typeof(a=void 0!==$&&$)&&a||Object])],t);var e,i,r,n,o,s,c,a}(),z=function(){function t(t){this._dDService=t,this.dChange=new p.EventEmitter,this.dDrop=new p.EventEmitter,this._materialStyle=!0,this._shadow=!1}return Object.defineProperty(t.prototype,"config",{set:function(t){t&&(this._direction=t.direction||null,this._materialStyle=void 0===t.matClick||t.matClick,this._shadow=void 0!==t.shadow&&t.shadow,this._customCollection=t.collection||null,this._swipe=t.swipe||null)},enumerable:!0,configurable:!0}),t.prototype.ngOnInit=function(){var e=this;this._dDService.drop.subscribe(function(t){return e._sendEvent(t)}),this._dDService.change.subscribe(function(t){return e._sendEvent(t)})},t.prototype._sendEvent=function(t){switch(t.type){case"change":this.dChange.emit(t);break;case"drop":this.dDrop.emit(t)}},t.prototype.ngAfterViewInit=function(){var i=this;this.collection.forEach(function(t,e){t.direction=t.direction?t.direction:i._direction,t.materialStyle=t.materialStyle?t.materialStyle:i._materialStyle,t.shadow=t.shadow?t.shadow:i._shadow,t.customElem=t.customElem?t.customElem:i._customCollection&&i._customCollection[e]||null,t.swipeElement=t.swipeElement?t.swipeElement:i._swipe,t.dDservice=i._dDService})},H([p.Input(),L("design:type",Object),L("design:paramtypes",[Object])],t.prototype,"config",null),H([p.ContentChildren(N),L("design:type","function"==typeof(e=void 0!==p.QueryList&&p.QueryList)&&e||Object)],t.prototype,"collection",void 0),H([p.Output(),L("design:type","function"==typeof(i=void 0!==p.EventEmitter&&p.EventEmitter)&&i||Object)],t.prototype,"dChange",void 0),H([p.Output(),L("design:type","function"==typeof(r=void 0!==p.EventEmitter&&p.EventEmitter)&&r||Object)],t.prototype,"dDrop",void 0),t=H([p.Component({selector:"d-d-material-style",template:"<ng-content></ng-content>",styles:["/deep/ d-d-mat-box-style {\n  transition: all 300ms ease-out;\n  transform: translateZ(0);\n  position: absolute;\n  float: left;\n  user-select: none;\n  border-radius: 5px; }\n  /deep/ d-d-mat-box-style.d-d-move {\n    transition: unset;\n    transform: translateZ(6px);\n    box-shadow: 0 0 4px rgba(0, 0, 0, 0.25); }\n  /deep/ d-d-mat-box-style .ripple {\n    position: absolute;\n    top: 0;\n    left: 0;\n    bottom: 0;\n    right: 0;\n    overflow: hidden;\n    -webkit-transform: translateZ(0);\n    transform: translateZ(0);\n    border-radius: inherit;\n    pointer-events: none;\n    animation: ripple-shadow 0.4s forwards;\n    -webkit-animation: ripple-shadow 0.4s forwards; }\n    /deep/ d-d-mat-box-style .ripple .rippleWave {\n      backface-visibility: hidden;\n      position: absolute;\n      border-radius: 50%;\n      transform: scale(0.7);\n      -webkit-transform: scale(0.7);\n      background: rgba(0, 0, 0, 0.3);\n      opacity: 0.45;\n      animation: ripple 2s forwards;\n      -webkit-animation: ripple 2s forwards; }\n\n@keyframes ripple-shadow {\n  0% {\n    box-shadow: 0 0 0 rgba(0, 0, 0, 0); }\n  20% {\n    box-shadow: 0 4px 16px rgba(0, 0, 0, 0.3); }\n  100% {\n    box-shadow: 0 0 0 rgba(0, 0, 0, 0); } }\n\n@-webkit-keyframes ripple-shadow {\n  0% {\n    box-shadow: 0 0 0 rgba(0, 0, 0, 0); }\n  20% {\n    box-shadow: 0 4px 16px rgba(0, 0, 0, 0.3); }\n  100% {\n    box-shadow: 0 0 0 rgba(0, 0, 0, 0); } }\n\n@keyframes ripple {\n  to {\n    transform: scale(24);\n    opacity: 0; } }\n\n@-webkit-keyframes ripple {\n  to {\n    -webkit-transform: scale(24);\n    opacity: 0; } }\n\n/deep/ .d-d-shadow {\n  background: rgba(0, 0, 0, 0.4);\n  box-shadow: inset 0 0 24px rgba(255, 255, 255, 0.4);\n  border-radius: 5px;\n  position: absolute;\n  display: block;\n  transition: opacity 200ms ease-out; }\n"],providers:[$]}),L("design:paramtypes",["function"==typeof(n=void 0!==$&&$)&&n||Object])],t);var e,i,r,n}(),B=function(){function t(){}return t=H([p.NgModule({declarations:[N,Z,z],exports:[N,z],providers:[$],entryComponents:[Z]})],t)}();t.DDMaterialStyleModule=B,Object.defineProperty(t,"__esModule",{value:!0})});